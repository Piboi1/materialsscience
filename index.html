<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Materials Science Interactive Models</title>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<style>
body { font-family: Arial, sans-serif; margin: 20px; }
.header { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
.header button { padding: 8px 16px; cursor: pointer; margin-bottom: 5px; }
.model-container { display: none; margin-top: 20px; }
.active { display: block; }
label { margin-right: 10px; }
</style>
</head>
<body>
<h1>Materials Science Interactive Models</h1>

<div class="header">
  <!-- Dislocations & Grain Boundaries -->
  <button onclick="showModel('dislocation')">3D Dislocations</button>
  <button onclick="showModel('grain')">2D Grain Boundary</button>

  <!-- Crystal Structures -->
  <button onclick="showModel('fcc')">FCC</button>
  <button onclick="showModel('bcc')">BCC</button>
  <button onclick="showModel('hcp')">HCP</button>
  <button onclick="showModel('sc')">SC</button>

  <!-- Point Defects -->
  <button onclick="showModel('vacancy')">Vacancy</button>
  <button onclick="showModel('interstitial')">Interstitial</button>
  <button onclick="showModel('impurity')">Impurity</button>
  <button onclick="showModel('frenkel')">Frenkel Defect</button>
  <button onclick="showModel('schottky')">Schottky Defect</button>

  <!-- Material Processing -->
  <button onclick="showModel('photolithography')">Photolithography</button>
  <button onclick="showModel('wetEtching')">Wet Etching</button>
  <button onclick="showModel('dryEtching')">Dry Etching</button>
  <button onclick="showModel('milling')">Milling</button>
  <button onclick="showModel('laser')">Laser Ablation</button>
  <button onclick="showModel('thinFilm')">Thin Film Patterning</button>
  <button onclick="showModel('ionBeam')">Ion Beam Lithography</button>
</div>

<!-- ---------------- Models ---------------- -->

<!-- 3D Dislocation -->
<div id="dislocation" class="model-container active">
<h2>3D Crystal Block: Edge vs Screw Dislocation</h2>
<label for="dislocationType">Dislocation Type:</label>
<select id="dislocationType">
  <option value="Edge">Edge</option>
  <option value="Screw">Screw</option>
</select>
<label for="dislocationPosition">Dislocation X Position:</label>
<input type="range" id="dislocationPosition" min="2" max="18" step="0.1" value="10">
<div id="dislocationPlot" style="width:90%;max-width:900px;height:600px;margin-top:20px;"></div>
</div>

<!-- 2D Grain Boundary -->
<div id="grain" class="model-container">
<h2>2D Grain Boundary</h2>
<label for="angle">Grain Misorientation Angle (degrees):</label>
<input type="range" id="angle" min="0" max="45" step="1" value="15">
<div id="grainPlot" style="width:90%;max-width:900px;height:600px;margin-top:20px;"></div>
</div>

<!-- Crystal Structures -->
<div id="fcc" class="model-container">
<h2>Face-Centered Cubic (FCC)</h2>
<p>Atoms at 8 corners + 6 face centers. Packing efficiency 74%. Examples: Copper, Aluminum, Gold.</p>
<div id="fccPlot" style="width:90%;max-width:600px;height:500px;margin-top:20px;"></div>
</div>

<div id="bcc" class="model-container">
<h2>Body-Centered Cubic (BCC)</h2>
<p>Atoms at 8 corners + 1 center. Packing efficiency 68%. Example: Iron.</p>
<div id="bccPlot" style="width:90%;max-width:600px;height:500px;margin-top:20px;"></div>
</div>

<div id="hcp" class="model-container">
<h2>Hexagonal Close-Packed (HCP)</h2>
<p>ABAB layering pattern. Packing efficiency 74%. Examples: Zinc, Magnesium.</p>
<div id="hcpPlot" style="width:90%;max-width:600px;height:500px;margin-top:20px;"></div>
</div>

<div id="sc" class="model-container">
<h2>Simple Cubic (SC)</h2>
<p>Atoms only at corners. Packing efficiency 52%. Very rare: Polonium.</p>
<div id="scPlot" style="width:90%;max-width:600px;height:500px;margin-top:20px;"></div>
</div>

<!-- Point Defects -->
<div id="vacancy" class="model-container">
<h2>Vacancy</h2>
<p>Missing atom – empty spot in lattice.</p>
<div id="vacancyPlot" style="width:90%;max-width:600px;height:500px;margin-top:20px;"></div>
</div>

<div id="interstitial" class="model-container">
<h2>Interstitial</h2>
<p>Extra atom squeezed into a gap (red atom slightly off-lattice).</p>
<div id="interstitialPlot" style="width:90%;max-width:600px;height:500px;margin-top:20px;"></div>
</div>

<div id="impurity" class="model-container">
<h2>Impurity</h2>
<p>Wrong type of atom in the structure (green atom).</p>
<div id="impurityPlot" style="width:90%;max-width:600px;height:500px;margin-top:20px;"></div>
</div>

<div id="frenkel" class="model-container">
<h2>Frenkel Defect</h2>
<p>An ion leaves its site and moves into a nearby gap. Red atom shows interstitial ion with "+" label.</p>
<div id="frenkelPlot" style="width:90%;max-width:600px;height:500px;margin-top:20px;"></div>
</div>

<div id="schottky" class="model-container">
<h2>Schottky Defect</h2>
<p>Positive and negative ions missing from lattice → move to nearby positions. "+" and "−" labels show moved ions, colored spheres indicate new positions.</p>
<div id="schottkyPlot" style="width:90%;max-width:600px;height:500px;margin-top:20px;"></div>
</div>

<!-- ---------------- Material Processing ---------------- -->
<div id="photolithography" class="model-container">
<h2>Photolithography / UV Lithography</h2>
<p>UV through patterned mask → resist changes → weak parts wash away → pattern left. Used in microchips.</p>
<label for="photoDepth">Pattern Depth:</label>
<input type="range" id="photoDepth" min="0" max="1" step="0.01" value="0.5">
<div id="photoPlot" style="width:90%;max-width:700px;height:400px;margin-top:20px;"></div>
</div>

<div id="wetEtching" class="model-container">
<h2>Wet Etching</h2>
<p>Submerge material in chemical → isotropic etch (all directions). Fast, cheap, less precise.</p>
<label for="wetDepth">Etch Depth:</label>
<input type="range" id="wetDepth" min="0" max="1" step="0.01" value="0.3">
<div id="wetPlot" style="width:90%;max-width:700px;height:400px;margin-top:20px;"></div>
</div>

<div id="dryEtching" class="model-container">
<h2>Dry Etching / Plasma Etching</h2>
<p>Bombard surface with plasma → removes material anisotropically (vertical). High precision.</p>
<label for="dryDepth">Etch Depth:</label>
<input type="range" id="dryDepth" min="0" max="1" step="0.01" value="0.4">
<div id="dryPlot" style="width:90%;max-width:700px;height:400px;margin-top:20px;"></div>
</div>

<div id="milling" class="model-container">
<h2>Milling / Mechanical Machining</h2>
<p>Physical cutting removes material. Used in engines, screws, metal parts. CNC for precision.</p>
<label for="millDepth">Cut Depth:</label>
<input type="range" id="millDepth" min="0" max="1" step="0.01" value="0.5">
<div id="millPlot" style="width:90%;max-width:700px;height:400px;margin-top:20px;"></div>
</div>

<div id="laser" class="model-container">
<h2>Laser Ablation</h2>
<p>Laser vaporizes material. Precision removal, microstructures, no contact.</p>
<label for="laserDepth">Ablation Depth:</label>
<input type="range" id="laserDepth" min="0" max="1" step="0.01" value="0.4">
<div id="laserPlot" style="width:90%;max-width:700px;height:400px;margin-top:20px;"></div>
</div>

<div id="thinFilm" class="model-container">
<h2>Thin Film Patterning</h2>
<p>Deposit uniform film → lithography + etch removes parts → multi-layer chip structures.</p>
<label for="filmDepth">Pattern Depth:</label>
<input type="range" id="filmDepth" min="0" max="1" step="0.01" value="0.5">
<div id="filmPlot" style="width:90%;max-width:700px;height:400px;margin-top:20px;"></div>
</div>

<div id="ionBeam" class="model-container">
<h2>Ion Beam Lithography</h2>
<p>Focused ions sputter atoms precisely. Ultra-accurate, nanoscale prototyping.</p>
<label for="ionDepth">Sputter Depth:</label>
<input type="range" id="ionDepth" min="0" max="1" step="0.01" value="0.3">
<div id="ionPlot" style="width:90%;max-width:700px;height:400px;margin-top:20px;"></div>
</div>

<script>
// ---------------- Tab Function ----------------
function showModel(id) {
  document.querySelectorAll('.model-container').forEach(div => div.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// ---------------- 3D Dislocation ----------------
const nx=20,ny=10,nz=5,b=1.0;
function generateLattice(){let X=[],Y=[],Z=[]; for(let k=0;k<nz;k++) for(let j=0;j<ny;j++) for(let i=0;i<nx;i++){X.push(i);Y.push(j);Z.push(k);} return {X,Y,Z};}
function edgeDisplacement(X, dislocX){return X.map(xi=>(xi>=dislocX?b:0));}
function screwDisplacement(X, dislocX){return X.map(xi=>b/(2*Math.PI)*Math.atan(xi-dislocX));}
function updateDislocation(){
  const type=document.getElementById("dislocationType").value;
  const dislocX=parseFloat(document.getElementById("dislocationPosition").value);
  const lattice=generateLattice();
  let Z_new=(type==="Edge")?lattice.Z.map((zi,idx)=>zi+edgeDisplacement(lattice.X,dislocX)[idx]):
                              lattice.Z.map((zi,idx)=>zi+screwDisplacement(lattice.X,dislocX)[idx]);
  Plotly.newPlot('dislocationPlot',[{x:lattice.X,y:lattice.Y,z:Z_new,mode:'markers',type:'scatter3d',marker:{size:4,color:Z_new,colorscale:'Viridis'}}],
    {title:`${type} Dislocation at X=${dislocX.toFixed(2)}`,scene:{xaxis:{title:'X'},yaxis:{title:'Y'},zaxis:{title:'Z'}}});
}
document.getElementById("dislocationType").addEventListener("change", updateDislocation);
document.getElementById("dislocationPosition").addEventListener("input", updateDislocation);
updateDislocation();

// ---------------- 2D Grain Boundary ----------------
const nx_g=20,ny_g=20;
function generateGrains(angleDeg){
  const X=[],Y=[],Z=[],C=[];
  const angleRad=angleDeg*Math.PI/180;
  for(let i=0;i<nx_g;i++) for(let j=0;j<ny_g;j++){X.push(i);Y.push(j);Z.push(0);C.push(0);}
  for(let i=0;i<nx_g;i++) for(let j=0;j<ny_g;j++){
    const x_rot=i*Math.cos(angleRad)-j*Math.sin(angleRad)+nx_g/2;
    const y_rot=i*Math.sin(angleRad)+j*Math.cos(angleRad);
    X.push(x_rot); Y.push(y_rot); Z.push(0); C.push(1);
  }
  return {X,Y,Z,C};
}
function updateGrainBoundary(){
  const angle=parseFloat(document.getElementById("angle").value);
  const lattice=generateGrains(angle);
  Plotly.newPlot('grainPlot',[{x:lattice.X,y:lattice.Y,z:lattice.Z,mode:'markers',type:'scatter3d',marker:{size:4,color:lattice.C,colorscale:'Portland'}}],
    {title:`2D Grain Boundary at ${angle}°`,scene:{xaxis:{title:'X'},yaxis:{title:'Y'},zaxis:{title:'Plane'}}});
}
document.getElementById("angle").addEventListener("input",updateGrainBoundary);
updateGrainBoundary();

// ---------------- Crystal Structures ----------------
function plotCubicWithBox(type,divId){
  const L=2;
  let X=[],Y=[],Z=[];
  if(type==="SC"||type==="BCC"||type==="FCC"){
    for(let i=0;i<=1;i++) for(let j=0;j<=1;j++) for(let k=0;k<=1;k++){X.push(i*L);Y.push(j*L);Z.push(k*L);}
    if(type==="BCC"){X.push(L/2);Y.push(L/2);Z.push(L/2);}
    if(type==="FCC"){
      X.push(L/2);Y.push(L/2);Z.push(0); X.push(L/2);Y.push(L/2);Z.push(L);
      X.push(L/2);Y.push(0);Z.push(L/2); X.push(L/2);Y.push(1);Z.push(L/2);
      X.push(0);Y.push(L/2);Z.push(L/2); X.push(1);Y.push(L/2);Z.push(L/2);
    }
    const corners=[[0,0,0],[L,0,0],[L,L,0],[0,L,0],[0,0,L],[L,0,L],[L,L,L],[0,L,L]];
    const edges=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]];
    let linesX=[],linesY=[],linesZ=[];
    edges.forEach(e=>{linesX.push(corners[e[0]][0],corners[e[1]][0],null);linesY.push(corners[e[0]][1],corners[e[1]][1],null);linesZ.push(corners[e[0]][2],corners[e[1]][2],null);});
    Plotly.newPlot(divId,[
      {x:X,y:Y,z:Z,type:'scatter3d',mode:'markers',marker:{size:6,color:'orange'}},
      {x:linesX,y:linesY,z:linesZ,type:'scatter3d',mode:'lines',line:{color:'black',width:2}}
    ],{scene:{xaxis:{title:'X'},yaxis:{title:'Y'},zaxis:{title:'Z'}}});
  } else if(type==="HCP"){
    const a=1,c=Math.sqrt(8/3);
    const layerA=[[0,0,0],[a,0,0],[a/2,a*Math.sqrt(3)/2,0]];
    const layerB=[[0,a*Math.sqrt(3)/3,c/2],[a,a*Math.sqrt(3)/3,c/2],[a/2,5*a*Math.sqrt(3)/6,c/2]];
    X=[];Y=[];Z=[];
    layerA.forEach(v=>{X.push(v[0]);Y.push(v[1]);Z.push(v[2]);});
    layerB.forEach(v=>{X.push(v[0]);Y.push(v[1]);Z.push(v[2]);});
    const hexCorners=[[0,0,0],[a,0,0],[3*a/2,a*Math.sqrt(3)/2,0],[a,a*Math.sqrt(3),0],[0,a*Math.sqrt(3),0],[-a/2,a*Math.sqrt(3)/2,0]];
    const edges=[[0,1],[1,2],[2,3],[3,4],[4,5],[5,0]];
    let ex=[],ey=[],ez=[];
    edges.forEach(e=>{ex.push(hexCorners[e[0]][0],hexCorners[e[1]][0],null);ey.push(hexCorners[e[0]][1],hexCorners[e[1]][1],null);ez.push(hexCorners[e[0]][2],hexCorners[e[1]][2],null);});
    Plotly.newPlot(divId,[{x:X,y:Y,z:Z,type:'scatter3d',mode:'markers',marker:{size:6,color:'orange'}},
      {x:ex,y:ey,z:ez,type:'scatter3d',mode:'lines',line:{color:'black',width:2}}],{scene:{xaxis:{title:'X'},yaxis:{title:'Y'},zaxis:{title:'Z'}}});
  }
}
plotCubicWithBox('FCC','fccPlot');
plotCubicWithBox('BCC','bccPlot');
plotCubicWithBox('HCP','hcpPlot');
plotCubicWithBox('SC','scPlot');

// ---------------- Point Defects ----------------
function plotPointDefect(type,divId){
  const L=3;
  let X=[],Y=[],Z=[],C=[];
  for(let i=0;i<=2;i++) for(let j=0;j<=2;j++) for(let k=0;k<=2;k++){X.push(i);Y.push(j);Z.push(k);C.push('blue');}
  if(type==="vacancy"){X.splice(13,1);Y.splice(13,1);Z.splice(13,1);}
  if(type==="interstitial"){X.push(1.5);Y.push(1.5);Z.push(1.5);C.push('red');}
  if(type==="impurity"){X[13]=1.5;Y[13]=1.5;Z[13]=1.5;C[13]='green';}
  if(type==="frenkel"){X.push(2);Y.push(2);Z.push(2);C.push('red');}
  if(type==="schottky"){X.splice(13,1);Y.splice(13,1);Z.splice(13,1);C.splice(13,1); X.push(0.5,2.5); Y.push(0.5,2.5); Z.push(0.5,2.5); C.push('purple','cyan');}
  Plotly.newPlot(divId,[{x:X,y:Y,z:Z,type:'scatter3d',mode:'markers',marker:{size:6,color:C}}],{scene:{xaxis:{title:'X'},yaxis:{title:'Y'},zaxis:{title:'Z'}}});
}
plotPointDefect('vacancy','vacancyPlot');
plotPointDefect('interstitial','interstitialPlot');
plotPointDefect('impurity','impurityPlot');
plotPointDefect('frenkel','frenkelPlot');
plotPointDefect('schottky','schottkyPlot');

// ---------------- Material Processing ----------------
function plotProcessingAtoms(divId, depth) {
    const size = 10;  // number of atoms in each direction
    let X = [], Y = [], Z = [], C = [];

    for (let i = 0; i <= size; i++) {
        for (let j = 0; j <= size; j++) {
            for (let k = 0; k <= size; k++) {
                // remove atoms below "depth * size" to simulate etching
                if (k > depth * size) {
                    X.push(i); 
                    Y.push(j); 
                    Z.push(k); 
                    C.push('orange'); // remaining material
                }
            }
        }
    }

    Plotly.newPlot(divId, [{
        x: X,
        y: Y,
        z: Z,
        type: 'scatter3d',
        mode: 'markers',
        marker: { size: 4, color: C }
    }], {
        scene: { xaxis: { title: 'X' }, yaxis: { title: 'Y' }, zaxis: { title: 'Z' } }
    });
}

// Example: link to sliders
['photo','wet','dry','mill','laser','film','ion'].forEach(id => {
    const slider = document.getElementById(id+'Depth');
    slider.addEventListener('input', () => plotProcessingAtoms(id+'Plot', slider.value));
    plotProcessingAtoms(id+'Plot', slider.value);
});
</script>
</body>
</html>
